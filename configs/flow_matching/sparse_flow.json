{
    "models": {
        "denoiser": {
            "name": "SparseFlowModel",
            "args": {
                "bottleneck_dim": 256,
                "model_channels": 1280,
                "cond_channels": 1024,
                "num_blocks": 32,
                "num_heads": 20,
                "mlp_ratio": 4,
                "pe_mode": "rope",
                "attn_mode": "windowed",
                "window_size": 32,
                "pool_stride": 4,
                "pool_stride_coarse": 8,
                "num_pooled_layers": 0,
                "use_fp16": true,
                "qk_rms_norm": true,
                "qk_rms_norm_cross": true,
                "use_checkpoint": true,
                "num_context_registers": 32,
                "context_start_block": 0
            }
        }
    },
    "dataset": {
        "name": "ImageConditionedBlockFeats",
        "args": {
            "roots": [
                "/mnt/data/yizhao/JiTData_Test"
            ],
            "max_block_num": 110000,
            "min_aesthetic_score": 0.0,
            "max_samples": 0
        }
    },
    "test_dataset": {
        "name": "ImageConditionedBlockFeats",
        "args": {
            "roots": [
                "/mnt/data/yizhao/TESTDATA"
            ],
            "max_block_num": 110000,
            "min_aesthetic_score": 0.0,
            "max_samples": 0
        }
    },
    "trainer": {
        "name": "ImageConditionedSparseFlowMultiTokenCFGTrainer",
        "args": {
            "max_steps": 100000,
            "batch_size_per_gpu": 1,
            "batch_split": 1,
            "loss_type": "v_loss",
            "lambda_normal": 0.1,
            "surface_weight": 8.0,
            "complexity_boost": 4.0,
            "cond_noise_std": 0.01,
            "t_schedule": {
                "name": "logitNormal",
                "args": {
                    "mean": -0.8,
                    "std": 0.8
                }
            },
            "optimizer": {
                "name": "AdamW",
                "args": {
                    "lr": 0.0001,
                    "weight_decay": 0,
                    "betas": [0.9, 0.95]
                }
            },
            "lr_scheduler": {
                "name": "WarmupCosineLRScheduler",
                "args": {
                    "warmup_steps": 5000,
                    "total_steps": 500000,
                    "min_lr_ratio": 0.01
                }
            },
            "ema_rate": [
                0.9999
            ],
            "grad_clip": {
                "name": "AdaptiveGradClipper",
                "args": {
                    "max_norm": 4.0,
                    "clip_percentile": 95
                }
            },
            "i_log": 100,
            "num_samples": 16,
            "i_sample": 5000,
            "i_save": 10000,
            "image_cond_model": "dinov2_vitl14_reg"
        }
    }
}